{"version":3,"sources":["toc.js","jquery.fitvids.js","gallery-card.js","infinite-scroll.js","sticky-nav-title.js"],"names":["getHeaderLevel","header","Number","nodeName","slice","createTocMarkup","headers","prevLevel","output","forEach","h","currLevel","ranOnce","id","innerText","getTocMarkup","document","getElementsByClassName","querySelectorAll","length","$","fn","fitVids","options","settings","customSelector","ignore","getElementById","head","getElementsByTagName","div","createElement","innerHTML","appendChild","childNodes","extend","this","each","selectors","push","ignoreList","$allVideos","find","join","not","$this","parents","tagName","toLowerCase","parent","css","isNaN","attr","aspectRatio","parseInt","height","width","videoName","_count","wrap","removeAttr","window","jQuery","Zepto","addEventListener","image","container","closest","ratio","attributes","value","style","flex","nextElement","querySelector","feedElement","ticking","loading","lastScrollY","scrollY","lastWindowHeight","innerHeight","lastDocumentHeight","documentElement","scrollHeight","onScroll","passive","onResize","requestTick","onPageLoad","status","removeEventListener","response","item","importNode","resNextElement","href","onUpdate","xhr","XMLHttpRequest","responseType","open","send","requestAnimationFrame","Casper","stickyNavTitle","nav","navSelector","title","titleSelector","update","trigger","getBoundingClientRect","top","triggerOffset","offsetHeight","classList","add","activeClass","remove"],"mappings":";;;;;;;;;;AAIA,SAAAA,eAAAC,GACA,OAAAC,OAAAD,EAAAE,SAAAC,OAAA,IAGA,SAAAC,gBAAAC,GACA,IAAAC,EAAA,EACAC,EAAA,GA2BA,GAzBAF,EAAAG,SAAA,SAAAC,GACA,IAAAC,EAAAX,eAAAU,GACA,GAAAC,EAAAJ,EAEA,IADA,IAAAK,GAAA,EACAD,EAAAJ,GACAK,IACAJ,GAAA,UAEAA,GAAA,qCACAD,GAAA,EACAK,GAAA,OAEA,GAAAD,GAAAJ,EACAC,GAAA,iBACA,GAAAG,EAAAJ,EAAA,CACA,KAAAI,EAAAJ,GACAC,GAAA,aACAD,GAAA,EAEAC,GAAA,OAGAA,GAAA,aAAAE,EAAAG,OAAAH,EAAAI,mBAGA,IAAAN,EAAA,CAEA,KAAAD,GAAA,GACAC,GAAA,aACAD,GAAA,EAEAC,EAAA,kDAAAA,IAGA,OAAAA,EAGA,SAAAO,aAAAC,GAIA,IAGAV,EAHAU,EAAAC,uBAAA,qBAAA,GAGAC,iBAAA,sBAIA,OAAAZ,EAAAa,QAAA,EACAd,gBAAAC,GAEA,ICnDA,SAAAc,GAEA,aAEAA,EAAAC,GAAAC,QAAA,SAAAC,GACA,IAAAC,EAAA,CACAC,eAAA,KACAC,OAAA,MAGA,IAAAV,SAAAW,eAAA,kBAAA,CAEA,IAAAC,EAAAZ,SAAAY,MAAAZ,SAAAa,qBAAA,QAAA,GAEAC,EAAAd,SAAAe,cAAA,OACAD,EAAAE,UAAA,oUACAJ,EAAAK,YAAAH,EAAAI,WAAA,IAOA,OAJAX,GACAH,EAAAe,OAAAX,EAAAD,GAGAa,KAAAC,MAAA,WACA,IAAAC,EAAA,CACA,kCACA,6BACA,sCACA,oDACA,SACA,SAGAd,EAAAC,gBACAa,EAAAC,KAAAf,EAAAC,gBAGA,IAAAe,EAAA,iBAEAhB,EAAAE,SACAc,EAAAA,EAAA,KAAAhB,EAAAE,QAGA,IAAAe,EAAArB,EAAAgB,MAAAM,KAAAJ,EAAAK,KAAA,OAEAF,GADAA,EAAAA,EAAAG,IAAA,kBACAA,IAAAJ,IAEAH,MAAA,WACA,IAAAQ,EAAAzB,EAAAgB,MACA,KAAAS,EAAAC,QAAAN,GAAArB,OAAA,GAGA,UAAAiB,KAAAW,QAAAC,eAAAH,EAAAI,OAAA,UAAA9B,QAAA0B,EAAAI,OAAA,8BAAA9B,QAAA,CACA0B,EAAAK,IAAA,WAAAL,EAAAK,IAAA,WAAAC,MAAAN,EAAAO,KAAA,aAAAD,MAAAN,EAAAO,KAAA,YAEAP,EAAAO,KAAA,SAAA,GACAP,EAAAO,KAAA,QAAA,KAEA,IAEAC,GAFA,WAAAjB,KAAAW,QAAAC,eAAAH,EAAAO,KAAA,YAAAD,MAAAG,SAAAT,EAAAO,KAAA,UAAA,KAAAE,SAAAT,EAAAO,KAAA,UAAA,IAAAP,EAAAU,WACAJ,MAAAG,SAAAT,EAAAO,KAAA,SAAA,KAAAP,EAAAW,QAAAF,SAAAT,EAAAO,KAAA,SAAA,KAEA,IAAAP,EAAAO,KAAA,QAAA,CACA,IAAAK,EAAA,SAAArC,EAAAC,GAAAC,QAAAoC,OACAb,EAAAO,KAAA,OAAAK,GACArC,EAAAC,GAAAC,QAAAoC,SAEAb,EAAAc,KAAA,gGAAAV,OAAA,8BAAAC,IAAA,cAAA,IAAAG,EAAA,KACAR,EAAAe,WAAA,UAAAA,WAAA,iBAMAxC,EAAAC,GAAAC,QAAAoC,OAAA,EAzEA,CA4EAG,OAAAC,QAAAD,OAAAE,OC9EA,SAAAF,EAAA7C,GAYAA,EAAAgD,iBAAA,oBAXA,WACAhD,EAAAE,iBAAA,yBACAT,SAAA,SAAAwD,GACA,IAAAC,EAAAD,EAAAE,QAAA,qBAGAC,EAFAH,EAAAI,WAAAb,MAAAc,MACAL,EAAAI,WAAAd,OAAAe,MAEAJ,EAAAK,MAAAC,KAAAJ,EAAA,cARA,CAaAP,OAAA7C,UCRA,SAAA6C,EAAA7C,GAEA,IAAAyD,EAAAzD,EAAA0D,cAAA,kBACA,GAAAD,EAAA,CAKA,IAAAE,EAAA3D,EAAA0D,cAAA,cACA,GAAAC,EAAA,CAIA,IAEAC,GAAA,EACAC,GAAA,EAEAC,EAAAjB,EAAAkB,QACAC,EAAAnB,EAAAoB,YACAC,EAAAlE,EAAAmE,gBAAAC,aAwEAvB,EAAAG,iBAAA,SAAAqB,EAAA,CAAAC,SAAA,IACAzB,EAAAG,iBAAA,SAAAuB,GAEAC,KAzEA,SAAAC,IACA,GAAA,MAAArD,KAAAsD,OAGA,OAFA7B,EAAA8B,oBAAA,SAAAN,QACAxB,EAAA8B,oBAAA,SAAAJ,GAKAnD,KAAAwD,SAAA1E,iBAAA,cACAT,SAAA,SAAAoF,GAIAlB,EAAA1C,YAAAjB,EAAA8E,WAAAD,GAAA,OAIA,IAAAE,EAAA3D,KAAAwD,SAAAlB,cAAA,kBACAqB,EACAtB,EAAAuB,KAAAD,EAAAC,MAEAnC,EAAA8B,oBAAA,SAAAN,GACAxB,EAAA8B,oBAAA,SAAAJ,IAIAL,EAAAlE,EAAAmE,gBAAAC,aACAR,GAAA,EACAC,GAAA,EAGA,SAAAoB,IAEA,IAAApB,EAKA,GAAAC,EAAAE,GAAAE,EA/CA,IAgDAN,GAAA,MADA,CAKAC,GAAA,EAEA,IAAAqB,EAAA,IAAArC,EAAAsC,eACAD,EAAAE,aAAA,WAEAF,EAAAlC,iBAAA,OAAAyB,GAEAS,EAAAG,KAAA,MAAA5B,EAAAuB,MACAE,EAAAI,KAAA,OAGA,SAAAd,IACAZ,GAAAf,EAAA0C,sBAAAN,GACArB,GAAA,EAGA,SAAAS,IACAP,EAAAjB,EAAAkB,QACAS,IAGA,SAAAD,IACAP,EAAAnB,EAAAoB,YACAC,EAAAlE,EAAAmE,gBAAAC,aACAI,KAzFA,CAgGA3B,OAAA7C,UC9FA,SAAA6C,EAAA7C,GAEA6C,EAAA2C,SACA3C,EAAA2C,OAAA,IAGA3C,EAAA2C,OAAAC,eAAA,SAAAlF,GACA,IAAAmF,EAAA1F,EAAA0D,cAAAnD,EAAAoF,aACAC,EAAA5F,EAAA0D,cAAAnD,EAAAsF,eAEA/B,EAAAjB,EAAAkB,QACAH,GAAA,EAcA,SAAAkC,IACA,IAAAC,EAAAH,EAAAI,wBAAAC,IAAApD,EAAAkB,QACAmC,EAAAN,EAAAO,aAAA,GAGArC,GAAAiC,EAAAG,EACAR,EAAAU,UAAAC,IAAA9F,EAAA+F,aAEAZ,EAAAU,UAAAG,OAAAhG,EAAA+F,aAGA1C,GAAA,EAGAf,EAAAG,iBAAA,UA1BA,WACAc,EAAAjB,EAAAkB,QAIA,WACAH,GACA2B,sBAAAO,GAEAlC,GAAA,EAPAY,KAwBA,CAAAF,SAAA,IAEAwB,KAzCA,CA2CAjD,OAAA7C","file":"casper.js","sourcesContent":["/**\n * For displaying a table of contents - pass the entire document (DOM) to getTocMarkup\n */\n\nfunction getHeaderLevel(header) {\n    return Number(header.nodeName.slice(-1));\n}\n\nfunction createTocMarkup(headers) {\n    var prevLevel = 1;\n    var output = \"\";\n\n    headers.forEach(function(h) {\n        var currLevel = getHeaderLevel(h);\n        if (currLevel > prevLevel) {\n            var ranOnce = false;\n            while (currLevel > prevLevel) {\n                if (ranOnce) {\n                    output += \"&nbsp;\";\n                }\n                output += \"<ul style=\\\"margin-bottom:0px\\\"><li>\";\n                prevLevel += 1;\n                ranOnce = true;\n            }\n        } else if (currLevel == prevLevel) {\n            output += \"</li><li>\";\n        } else if (currLevel < prevLevel) {\n            while (currLevel < prevLevel) {\n                output += \"</li></ul>\";\n                prevLevel -= 1;\n            }\n            output += \"<li>\";\n        }\n\n        output += `<a href=\"#${h.id}\">${h.innerText}</a>`;\n    });\n\n    if (output != \"\") {\n        // Change 2 to the max header level you want in the TOC; in my case, H2\n        while (prevLevel >= 2) {\n            output += \"</li></ul>\";\n            prevLevel -= 1;\n        }\n        output = `<h2 class=\"widget-title\">Table of Contents</h2>${output}`;\n    }\n\n    return output;\n}\n\nfunction getTocMarkup(document) {\n    // I was only interested in the headers within the element that had the .post-content class,\n    // which is specific to the Ghost blog. If you're using this elsewhere, or are interested in\n    // the entire document, delete this line and use document.querySelectorAll(...) on the next line.\n    var body = document.getElementsByClassName('post-full-content')[0];\n    \n    // Add or remove header tags you do (or don't) want to include in the TOC\n    var headers = body.querySelectorAll('h2, h3, h4, h5, h6');\n\n    // Change the number to 1 if you want headers no matter what.\n    // Or if you want at least 3 headers before generating a TOC, change it to 3.\n    if (headers.length >= 2) {\n        return createTocMarkup(headers);\n    } else {\n        return \"\";\n    }\n}\n","/*jshint browser:true */\n/*!\n* FitVids 1.3\n*\n*\n* Copyright 2017, Chris Coyier + Dave Rupert + Ghost Foundation\n* This is an unofficial release, ported by John O'Nolan\n* Credit to Thierry Koblentz - http://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/\n* Released under the MIT license\n*\n*/\n\n;(function( $ ){\n\n  'use strict';\n\n  $.fn.fitVids = function( options ) {\n    var settings = {\n      customSelector: null,\n      ignore: null\n    };\n\n    if(!document.getElementById('fit-vids-style')) {\n      // appendStyles: https://github.com/toddmotto/fluidvids/blob/master/dist/fluidvids.js\n      var head = document.head || document.getElementsByTagName('head')[0];\n      var css = '.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}';\n      var div = document.createElement(\"div\");\n      div.innerHTML = '<p>x</p><style id=\"fit-vids-style\">' + css + '</style>';\n      head.appendChild(div.childNodes[1]);\n    }\n\n    if ( options ) {\n      $.extend( settings, options );\n    }\n\n    return this.each(function(){\n      var selectors = [\n        'iframe[src*=\"player.vimeo.com\"]',\n        'iframe[src*=\"youtube.com\"]',\n        'iframe[src*=\"youtube-nocookie.com\"]',\n        'iframe[src*=\"kickstarter.com\"][src*=\"video.html\"]',\n        'object',\n        'embed'\n      ];\n\n      if (settings.customSelector) {\n        selectors.push(settings.customSelector);\n      }\n\n      var ignoreList = '.fitvidsignore';\n\n      if(settings.ignore) {\n        ignoreList = ignoreList + ', ' + settings.ignore;\n      }\n\n      var $allVideos = $(this).find(selectors.join(','));\n      $allVideos = $allVideos.not('object object'); // SwfObj conflict patch\n      $allVideos = $allVideos.not(ignoreList); // Disable FitVids on this video.\n\n      $allVideos.each(function(){\n        var $this = $(this);\n        if($this.parents(ignoreList).length > 0) {\n          return; // Disable FitVids on this video.\n        }\n        if (this.tagName.toLowerCase() === 'embed' && $this.parent('object').length || $this.parent('.fluid-width-video-wrapper').length) { return; }\n        if ((!$this.css('height') && !$this.css('width')) && (isNaN($this.attr('height')) || isNaN($this.attr('width'))))\n        {\n          $this.attr('height', 9);\n          $this.attr('width', 16);\n        }\n        var height = ( this.tagName.toLowerCase() === 'object' || ($this.attr('height') && !isNaN(parseInt($this.attr('height'), 10))) ) ? parseInt($this.attr('height'), 10) : $this.height(),\n            width = !isNaN(parseInt($this.attr('width'), 10)) ? parseInt($this.attr('width'), 10) : $this.width(),\n            aspectRatio = height / width;\n        if(!$this.attr('name')){\n          var videoName = 'fitvid' + $.fn.fitVids._count;\n          $this.attr('name', videoName);\n          $.fn.fitVids._count++;\n        }\n        $this.wrap('<div class=\"fluid-width-video-container\"><div class=\"fluid-width-video-wrapper\"></div></div>').parent('.fluid-width-video-wrapper').css('padding-top', (aspectRatio * 100)+'%');\n        $this.removeAttr('height').removeAttr('width');\n      });\n    });\n  };\n\n  // Internal counter for unique video names.\n  $.fn.fitVids._count = 0;\n\n// Works with either jQuery or Zepto\n})( window.jQuery || window.Zepto );\n","/* eslint-env browser */\n\n/**\n * Gallery card support\n * Used on any individual post/page\n *\n * Detects when a gallery card has been used and applies sizing to make sure\n * the display matches what is seen in the editor.\n */\n\n(function (window, document) {\n    var resizeImagesInGalleries = function resizeImagesInGalleries() {\n        var images = document.querySelectorAll('.kg-gallery-image img');\n        images.forEach(function (image) {\n            var container = image.closest('.kg-gallery-image');\n            var width = image.attributes.width.value;\n            var height = image.attributes.height.value;\n            var ratio = width / height;\n            container.style.flex = ratio + ' 1 0%';\n        });\n    };\n\n    document.addEventListener('DOMContentLoaded', resizeImagesInGalleries);\n})(window, document);\n","/* eslint-env browser */\n\n/**\n * Infinite Scroll\n * Used on all pages where there is a list of posts (homepage, tag index, etc).\n *\n * When the page is scrolled to 300px from the bottom, the next page of posts\n * is fetched by following the the <link rel=\"next\" href=\"...\"> that is output\n * by {{ghost_head}}.\n *\n * The individual post items are extracted from the fetched pages by looking for\n * a wrapper element with the class \"post-card\". Any found elements are appended\n * to the element with the class \"post-feed\" in the currently viewed page.\n */\n\n(function (window, document) {\n    // next link element\n    var nextElement = document.querySelector('link[rel=next]');\n    if (!nextElement) {\n        return;\n    }\n\n    // post feed element\n    var feedElement = document.querySelector('.post-feed');\n    if (!feedElement) {\n        return;\n    }\n\n    var buffer = 300;\n\n    var ticking = false;\n    var loading = false;\n\n    var lastScrollY = window.scrollY;\n    var lastWindowHeight = window.innerHeight;\n    var lastDocumentHeight = document.documentElement.scrollHeight;\n\n    function onPageLoad() {\n        if (this.status === 404) {\n            window.removeEventListener('scroll', onScroll);\n            window.removeEventListener('resize', onResize);\n            return;\n        }\n\n        // append contents\n        var postElements = this.response.querySelectorAll('.post-card');\n        postElements.forEach(function (item) {\n            // document.importNode is important, without it the item's owner\n            // document will be different which can break resizing of\n            // `object-fit: cover` images in Safari\n            feedElement.appendChild(document.importNode(item, true));\n        });\n\n        // set next link\n        var resNextElement = this.response.querySelector('link[rel=next]');\n        if (resNextElement) {\n            nextElement.href = resNextElement.href;\n        } else {\n            window.removeEventListener('scroll', onScroll);\n            window.removeEventListener('resize', onResize);\n        }\n\n        // sync status\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        ticking = false;\n        loading = false;\n    }\n\n    function onUpdate() {\n        // return if already loading\n        if (loading) {\n            return;\n        }\n\n        // return if not scroll to the bottom\n        if (lastScrollY + lastWindowHeight <= lastDocumentHeight - buffer) {\n            ticking = false;\n            return;\n        }\n\n        loading = true;\n\n        var xhr = new window.XMLHttpRequest();\n        xhr.responseType = 'document';\n\n        xhr.addEventListener('load', onPageLoad);\n\n        xhr.open('GET', nextElement.href);\n        xhr.send(null);\n    }\n\n    function requestTick() {\n        ticking || window.requestAnimationFrame(onUpdate);\n        ticking = true;\n    }\n\n    function onScroll() {\n        lastScrollY = window.scrollY;\n        requestTick();\n    }\n\n    function onResize() {\n        lastWindowHeight = window.innerHeight;\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        requestTick();\n    }\n\n    window.addEventListener('scroll', onScroll, {passive: true});\n    window.addEventListener('resize', onResize);\n\n    requestTick();\n})(window, document);\n","/* eslint-env browser */\n\n/**\n * Nav/Title replacement\n * Used on invividual post pages, displays the post title in place of the nav\n * bar when scrolling past the title\n *\n * Usage:\n * ```\n * Casper.stickyTitle({\n *     navSelector: '.site-nav-main',\n *     titleSelector: '.post-full-title',\n *     activeClass: 'nav-post-title-active'\n * });\n * ```\n */\n\n(function (window, document) {\n    // set up Casper as a global object\n    if (!window.Casper) {\n        window.Casper = {};\n    }\n\n    window.Casper.stickyNavTitle = function stickyNavTitle(options) {\n        var nav = document.querySelector(options.navSelector);\n        var title = document.querySelector(options.titleSelector);\n\n        var lastScrollY = window.scrollY;\n        var ticking = false;\n\n        function onScroll() {\n            lastScrollY = window.scrollY;\n            requestTick();\n        }\n\n        function requestTick() {\n            if (!ticking) {\n                requestAnimationFrame(update);\n            }\n            ticking = true;\n        }\n\n        function update() {\n            var trigger = title.getBoundingClientRect().top + window.scrollY;\n            var triggerOffset = title.offsetHeight + 35;\n\n            // show/hide post title\n            if (lastScrollY >= trigger + triggerOffset) {\n                nav.classList.add(options.activeClass);\n            } else {\n                nav.classList.remove(options.activeClass);\n            }\n\n            ticking = false;\n        }\n\n        window.addEventListener('scroll', onScroll, {passive: true});\n\n        update();\n    };\n})(window, document);\n"]}
